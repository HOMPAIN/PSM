# 7 Команды
Список Bluetooth команд для контроллера PSM.
Инструкция по их применению и настройке описана в разделе [Настройка контроллера](9-nastroyka-kontrollera).

**Команды чтения параметров:**  
`vresion` - возвращает версию прошивки контроллера.  
`volt` - возвращает текущее напряжение питания.  
`curr` - возвращает текущий ток потребления.  
`erpm` - возвращает текущие электрические обороты двигателя. erpm = rpm* pole_pairs.  
`rpm` - возвращает текущие обороты двигателя. Для правильной работы необходимо задать `pole_pairs`.   
`t_esc` - возвращает температуру контроллера в градусах цельсия.  Температура с датчика обычно выше температуры корпуса с наружи на 10-15 градусов. Нормальное значение температуры во время работы 50-60 градусов. При 70 градусах срабатывает защиты, контроллер отключается и ждёт снижения температуры.
`t_mot` - возвращает температуру мотора в градусах цельсия.  
`trot` - возвращает текущее значение положения ручки газа.  
`info` - краткая сводка основных параметрах (напряжение, ток, температура).

**Команды настройки:**  
Более подробное описание настройки описано в разделах [Настройка мотора](8-nastroyka-motor) и [Настройка ручки газа](7-nastroyka-ruchki-gaza).
`calib_motor` - начать настройку двигателя. В качестве параметра указывается мощность в Вт потребляемая при калибровке, при задании команды без параметра по умолчанию выбирается 50Вт.
`calib_trot` - начать калибровку ручки газа.  
`pole_pairs` - задать число пар полюсов двигателя. Необходимо задать для правильного отображения оборотов, не влияет на работу мотора.  

**Команды настройки ограничений:**  
Ограничения напряжения и тока указываются в милливольтах и миллиампирах. Например, что бы указать ограничение 54В, нужно ввести команду `v_min 54000`.
Более подробно про настройку ограничений в разделе [Настройка ограничений](6-nastroyka-ogranicheniy-toka).
`v_min` - задать минимальное напряжение батареи в мВ, ниже которого контроллер будет ограничивать ток.  
`v_max` - задать максимальное напряжение батареи в мВ, выше которого контроллер будет отлучать рекуперацию.  
`curr_max` - задать максимальный ток батареи в мА.  
`curr_max_recovery` - задать максимальный обратный ток рекуперации батареи в мА.
`curr_phase_max_forward` - ограничение фазного тока в прямом направлении(разгон) в мА.
`cpmf` - аналогично *curr_phase_max_forward*, сокращённая команда.
`curr_phase_max_revers` - ограничение фазного тока в обратном направлении(торможение) в мА.
`cpmr` - аналогично *curr_phase_max_revers*, сокращённая команда.
`curr_phase_min` - экспериментальная настройка, задаёт минимальный фазный ток в мА, ниже которого мотор отключается для экономии заряда. Не рекомендуется задавать более 3000мА.
`erpm_max` - ограничение электрических оборотов двигателя. Экспериментально, мотор может пульсировать при ограничении.
`rpm_max` - ограничение оборотов двигателя. Экспериментально, мотор может пульсировать при ограничении.

**Сохранение параметров:**
`save` - сохранить параметры. После сохранения необходима перезагрузка ключом зажигания.

**Дополнительные команды**
`bms` - расход заряда батареи с последнего включение. Выводится: изменение напряжения, потраченный заряд в Вт/ч и мА/ч с учётом рекуперации и в скобках отдельно выводится восстановленный заряд за счёт рекуперации.
`odo` - команда показывает текущий пробег в км, время в движении и с момента включения и расход энергии вт*ч/км за поездку.
`odo_calib` - калибровка одометра, в данной команде необходимо ввести пройденное расстояние с момента включения в **метрах**. Можно откалибровать транспорт дома по рулетке 3-5м, либо на улице предварительно замерив расстояние по карте. Пример: `odo_calib 1000` - калибровка при пройденной дистанции 1000м.
`speed` - выводит текущую скорость в км/ч. Для корректной работы спидометра необходимо откалибровать одометр.
`speed_limit` - установить ограничение скорости в км/ч. Пример: `speed_limit 25` - ограничение скорости 25 в км/ч.
`mode` - режим работы. `mode 0` - программно выключить контроллер, `mode 3` - обычный режим. Другие режимы используются для различных режимов калибровки, выбирать их вручную нельзя.