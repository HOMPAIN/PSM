# Настройка контроллера
Настройку контроллера осуществляется по Bluetooth. Для настройки необходим телефон на Android или ПК на Windows 10/11 с поддержкой Bluetooth 4.0 и выше со стандартом Bluetooth Low Energy.  
Взаимодействие с контроллером осуществляется за счёт отправки текстовых команд и значений через BLE терминал.

## Приложение для настройки
Для **Windows** использектся приложение ПППП.  
Для **Android** используется приложени реализующее BLE Терминал. Наиболее удобное [BLE Terminal](https://play.google.com/store/apps/details?id=com.mightyit.gops.bleterminal&hl=en).  
![https://play-lh.googleusercontent.com/O1mO9XYyjQ4TrmOPRTM3-WubYtCqBBFmBXj8D_fA1VSdh1qCv_stl5rhEOQ8tbRjG76D=w480-h960-rw](https://play-lh.googleusercontent.com/O1mO9XYyjQ4TrmOPRTM3-WubYtCqBBFmBXj8D_fA1VSdh1qCv_stl5rhEOQ8tbRjG76D=s128-rw)  
Для **iPhone** работа с iPhone также возможначерез стандартное приложение BLE терминала, однако работа с iPhone не тестировалась и данный вариант не рекомендуется на данный момент.  

## Подключение по Bluetooth
При подключении к контроллеру, он должен быть подключен к батарее и замок зажигания должен быть включен.  
Подключение в **Windows** происходит автоматически.  
На **Android** приложению необходимо дать разрешение на поиск устройств по близости. Затем в приложении найти устройство с названием вида `ImpESC_xxxx` и подключиться к нему.  

## Команды
Для чтения и запись параметров используются текстовые команды.  
Так, например, что бы узнать версию прошивки нужно ввести команду `version`,  в ответ придёт версия прошивки `Version 3.144`.  
Что бы записать значение, нужно после команды через пробел добавить значение. Например, команда `pole_pairs 4` установит количество пар полюсов магнитов мотора равным 4. В случаи корректно введённой команды, в ответ придёт подтвержение с теущим значением числа пар полюсов.  
Если команда была введена с ошибкой, в ответ придёт сообщение `wrong command`.  
При изменее параметра, он сразу применяется, но после выключения он не сохраниться. Для сохранения используется [команда `save`](##Сохранение-параметров).  
Список всех доступных команд доступен в разделе [Команды](Команды.md).

## Первое включение
После подключение всех проводов к контроллеру необходимо провести настройку.  
Первичная настройка состоит из следующих этапов:
- [Настройка мотора](Настройка%20мотора.md)
- [Настройка ручки газа](Настройка%20ручки%20газа.md)
- [Настройка ограничений тока](Настройка%20ограничений.md)

После проходения всех этапов настройки, параметры необходимо сохранить и перезапустить контроллер.  
### Дополнительная оптимизация
Во время первой поездки, в течении 10минут контроллер оптимизирует свои параметры. Если результат работы вас устроит, нужно будет произвести повторное сохранение. Если настройки оптимизации не сохранить, то после выключения питания они сбросятся и при следующем включении первые минуты поездки контроллер будет оптимизировать свои параметры заново.

## Сохранение параметров
Для сохранения текущих параметров необходимо ввести команду `save`, после чего необходимо перезапустить контроллер ключём зажигания.  
Что бы сбросить контроллер к заводским настройкам необходимо ввести команду `save_clear`.

